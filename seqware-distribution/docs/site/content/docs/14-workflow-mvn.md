---

title:                 "Creating New Workflow Bundles and Modules Using Maven Archetypes"
toc_includes_sections: true
markdown:              basic

---


The SeqWare workflow archetype and module archetype allow workflow developers to quickly create workflows and modules. The Maven archetypes generate skeletons (of workflows or modules) that contain a simple example program that can be modified to create a new workflow or module. The archetypes also take parameters prior to skeleton generation that allow the name of the workflow or module to be specified and all configuration files to adjusted with respect to these parameters.

The code generated by the archetype contains all the necessary files to generate a complete workflow bundle or module when the <tt>mvn install</tt> command is issued. This command will combine the .ini file and the user created Java file with other external dependencies pulled in by Maven to create a complete workflow bundle or module. This makes the code  generated by the archetype ideal to place under version control. As maintenance changes are made to the Java file or any other aspect of the workflow, these files can be updated and a new workflow reflecting these changes can be generated by re-issuing the  <tt>mvn install</tt> command.

##Installation


The Maven archetypes are part of SeqWare and are automatically installed when the SeqWare source is checked out and compiled with the <tt>mvn install</tt> command.

	$ cd  /home/seqware/seqware-github-development 
	$ mvn clean install

If you are working on a development version and encounter errors, you can skip tests by issuing the following command:

	$ mvn install -Dmaven.test.skip=true
 	
 	
##Usage


Change to a directory where you want to create a new workflow bundle.

	$ cd /home/seqware/SeqWare  
	$ mkdir maven-bundles 
	$ cd maven-bundles 

Run the command to create a new workflow or module skeleton. The new code will be placed in a child directory.

	$ mvn archetype:generate

	...
	660: local -> com.github.seqware:seqware-archetype-workflow (SeqWare workflow archetype)
	661: local -> com.github.seqware:seqware-archetype-java-workflow (SeqWare Java workflow archetype)
	662: local -> com.github.seqware:seqware-archetype-ftl-workflow (SeqWare FTL workflow archetype)
	Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 205:

The numbers used to identify  the archetypes (660,661,662) will vary, so you will need to scan through the list to find the SeqWare archetype you're looking for.

661: if you want to write your workflow using Java objects.

662: if you want to write your workflow using FTL.

<b>SeqWare WorkflowV2 Archetype</b>

	$ mvn archetype:generate
	...
	660: local -> com.github.seqware:seqware-archetype-workflow (SeqWare workflow archetype)
	661: local -> com.github.seqware:seqware-archetype-java-workflow (SeqWare Java workflow archetype)
	662: local -> com.github.seqware:seqware-archetype-ftl-workflow (SeqWare FTL workflow archetype)
	Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 205: 661
	Define value for property 'groupId': : net.sf.seqware
	Define value for property 'artifactId': : workflow-helloworld-example
	Define value for property 'version': 1.0-SNAPSHOT: 1.0
	Define value for property 'package': net.sf.seqware:
	Define value for property 'workflowDirectoryName': : helloworld_example
	Define value for property 'workflowName': : HelloWorldExample
	Confirm properties configuration:
	groupId: net.sf.seqware
	artifactId: workflow-helloworld-example
	version: 1.0
	package: net.sf.seqware
	workflowDirectoryName: helloworld_example
	workflowName: HelloWorldExample
	workflowVersion: 1.0

* groupId
: The workflow belongs to this group. This group id is part of the workflow's unique identity.
* artifactId
: The specific name of the workflow. Also part of the workflow's unique identity. This will also be used as the name of the directory containing all the files associated with this workflow.
* version
: The version of this workflow. Again, part of the workflow's unique identity. When maintaining the code in the future it will be possible to update this value.
* package
: This is a java package name. In the context of creating a workflow this is not used. Just press enter.
* workflowDirectoryName
: A unique workflow directory name. No spaces. All lowercase, separated by underscores.
* workflowName
: A unique camel case workflow name.

<!-- this explicit pre tag should be avoided, but the automatic nanoc formatting does not 
seem to work here -->
<pre>
	$ cd workflow-helloworld-example
	$ ls
	pom.xml src workflow  workflow.properties
</pre>

* pom.xml
: A maven project file. Edit this to change the version of the workflow and to add or modify workflow dependencies such as program, modules and data.
* workflow
: This directory contains the workflow skeleton. Look in here to modify the workflow .ini, .java files (Java workflow) or workflow.ftl(FTL workflow). The examples of Java and FTL can be found <a href="/docs/15-workflow-examples/">here</a>.
* src 
: This directory contains the Java client. Look in here to modify the .java files (Java workflow). The examples of Java and FTL can be found <a href="/docs/15-workflow-examples/">here</a>.
* workflow.properties
: Edit the description and workflow names in this file.


## Variables

Automatically Defined
* ${date}: a string representing the date the DAX was created, this is always defined so consider this a reserved variable name. 

* ${random}: a randomly generated string, this is always defined so consider this a reserved variable name. 

* ${workflow_bundle_dir}: if this workflow is part of a workflow bundle this variable will be defined and points to the path of the root of the directory this workflow bundle has been expanded to. 

* ${workflow_base_dir}: ${workflow_bundle_dir}/Workflow_Bundle_{workflow_name}/{workflow_version}

## Building the Workflow

The archetype is just a template for the workflow bundle.  You need to use "mvn install" to actually build the workflow bundle.

	$ mvn install
	[INFO] Scanning for projects...
	[INFO] 	------------------------------------------------------------------------
	[INFO] Building seqware-workflow
	...
	[INFO] 	-----------------------------------------------------	-------------------
	[INFO] BUILD SUCCESSFUL
	[INFO] 	------------------------------------------------------------------------
	[INFO] Total time: 22 seconds
	[INFO] Finished at: Wed Feb 22 15:22:05 EST 2012
	[INFO] Final Memory: 46M/448M
	[INFO] 	------------------------------------------------------------------------

##Testing the Workflow

	java -jar target/Workflow_Bundle_vep_1.0_SeqWare_0.12.5-SNAPSHOT/Workflow_Bundle_vep/1.0/lib/seqware-distribution-0.12.5-SNAPSHOT-full.jar --plugin net.sourceforge.seqware.pipeline.plugins.WorkflowLauncherV2 --  --provisioned-bundle-dir target/Workflow_Bundle_vep_1.0_SeqWare_0.12.5-SNAPSHOT/ --workflow vep --version 1.0 --ini-files target/Workflow_Bundle_vep_1.0_SeqWare_0.12.5-SNAPSHOT/Workflow_Bundle_vep/1.0/config/workflow.ini --wait
	
output:

	SUBMITTING TO PEGASUS: pegasus-plan -Dpegasus.user.properties=/u/seqwaretest/.seqware/pegasus/properties --dax /tmp/dax63588764095847722002087051279420911 --dir /u/seqwaretest/seqware-development/pegasus-dax -o sqwstage.hpc.oicr.on.ca --force --submit -s sqwstage.hpc.oicr.on.ca
	PEGASUS STATUS COMMAND: pegasus-status -l /u/seqwaretest/seqware-development/pegasus-dax/seqwaretest/pegasus/vep/run0043
	MONITORING PEGASUS STATUS:
	RUNNING: step 1 of 33 (3%)
	RUNNING: step 2 of 33 (6%)
	RUNNING: step 3 of 33 (9%)
	RUNNING: step 8 of 33 (24%)
	RUNNING: step 18 of 33 (54%)
	RUNNING: step 26 of 33 (78%)
	RUNNING: step 29 of 33 (87%)
	RUNNING: step 30 of 33 (90%)
	RUNNING: step 31 of 33 (93%)
	RUNNING: step 32 of 33 (96%)
	WORKFLOW COMPLETED SUCCESSFULLY!
